name: CD Pipeline
on:
  release:
    types: [published, edited]
    tags:
      - 'v\d+\.\d+\.\d+'
jobs:
  release-file-uploaded:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v2
      - name: Get release info
        uses: actions/github-script@v5
        id: get_release_info
        with:
          script: |
            console.log(`Release name: ${context.payload.release.tag_name}`);
            console.log(`Release tag: ${context.payload.release}`);
            "tag_name=${context.payload.release.tag_name}" >> $GITHUB_OUTPUT
      - name: Print release info
        run: |
          echo "Release name: ${{ steps.get_release_info.outputs.tag_name }}"
          echo "Release name: ${{ env.tag_name }}"
      - name: Download release asset
        uses: actions/download-artifact@v2
        with:
          name: mqtest.bar
          path: test.bar
      - name: Do something with the file
        run: sleep 240

